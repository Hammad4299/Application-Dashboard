webpackJsonp([1],[function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function t(){a(this,t),this.timeHelper=null},i=new r;e.default=i},,function(t,e){t.exports=moment},,function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(){function t(e){a(this,t),this.setTimezone(e),this.dateTimeFormat="YYYY-MM-DD hh:mm a"}return r(t,[{key:"setTimezone",value:function(t){this.userTimezone=t}},{key:"getUserUtcOffset",value:function(){var t=i().utcOffset();return this.userTimezone&&(t=60*parseInt(this.userTimezone)),t}},{key:"convertUtcToUserTime",value:function(t,e){return i.utc(t,e).utcOffset(this.getUserUtcOffset())}},{key:"timestampToLocal",value:function(t){return this.convertUtcToUserTime(""+t,"X").format(this.dateTimeFormat)}},{key:"userTime",value:function(){return i.utc().utcOffset(this.getUserUtcOffset())}},{key:"convertLocalToUtc",value:function(e,n){var a=i(e,n);return t.convertTimeToDifferentZone(e,n,a.utcOffset(),this.getUserUtcOffset()).utcOffset(0)}},{key:"updateTimes",value:function(e){var n=this;e.closest("[data-convert-time]").each(function(){var e=$(this),a=e.attr("data-convert-time"),r=null;r="now"===a.toLowerCase()?n.userTime():"utcnow"===a.toLowerCase()?t.utcTime():n.convertUtcToUserTime(a,t.getParsePattern(e,!1));var i=r.format(e.attr("data-format-pattern")),o=e.attr("data-attr");t.setTimeData(i,o,e)})}},{key:"setUserTimeToUtc",value:function(e){function n(e,n,a){var r=a.find(n.attr("data-target")),i=r.attr("data-attr"),o=e.format(r.attr("data-format-pattern"));t.setTimeData(o,i,r)}var a=t.getParent(e),r=e.val(),i=t.getParsePattern(e,!0),o=null;e.attr("data-linked")&&(o=a.find(e.attr("data-linked")),r+=" "+o.val(),i+=" "+t.getParsePattern(o,!0));var s=this.convertLocalToUtc(r,i);n(s,e,a),o&&n(s,o,a)}}],[{key:"utcTime",value:function(){return i.utc()}},{key:"convertTimeToDifferentZone",value:function(t,e,n,a){return i(t,e).subtract(a-n,"minutes").utcOffset(a)}},{key:"setTimeData",value:function(t,e,n){e&&e.length>0?"value"==e?n.val(t):n.attr(e,t):n.text(t)}},{key:"getParsePattern",value:function(t,e){var n=t.attr("data-change-parse-pattern"),a=t.attr("data-parse-pattern");return n||(n=t.attr("data-parse-pattern")),e?n:a}},{key:"getParent",value:function(t){var e=t.parent();return t.attr("data-parent")&&(e=t.parents(t.attr("data-parent"))),e}}]),t}();e.default=o},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){a(this,t)}return r(t,[{key:"replaceUrlParams",value:function(t,e,n){var a=$("#appId").val();if(t=t.replace("###",a),n.length>0){var r=$(e).data(n);t=t.replace("##",r)}return t}}]),t}(),o=new i;e.default=o},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(5),r=n(0),i=n(25),o=n(2),s=new i.default,u=function(t,e){var n=t.getVisitScreens(),a=[],r={};n.map(function(t){var e=new i.FlattenedActionData;r[t.actionName]?e=r[t.actionName]:(e.actionName=t.actionName,e.duration=0,e.timestamp=t.timestamp,a.push(e),r[t.actionName]=e),e.duration=e.duration+t.duration}),null!=c&&c.destroy(),c=e.find(".js-screens-table").DataTable({data:a,pageLength:10,searching:!1,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],columns:[{title:"Screen Name",data:"actionName"},{title:"Visited At",data:"timestampFormatted"},{title:"Duration",data:"durationFormatted"}]}),null!=f&&f.destroy(),f=e.find(".js-events-table").DataTable({data:t.getFlattenedEvents(),pageLength:50,searching:!1,lengthMenu:[[50,100,200,-1],[50,100,200,"All"]],columns:[{title:"Action Name",data:"actionName"},{title:"Action Performed",data:"actionPerformed"},{title:"Timestamp",data:"timestampFormattedWithTime"},{title:"Value",data:"eventValue"}]})},c=null,f=null,l=null;$(document).on("click",".js-analytics-by-date",function(){var t=$(this).parent().find(".js-flatpickr"),e=t.val().split(" to ")[0],n=t.val().split(" to ")[1];if(""==e||""==n)return!1;var a=$("#myModal");s.getUserAnalyticDetail(l,e,n,function(t){u(t,a)})}),$(document).on("click",".js-analytics-detail",function(){var t=$(this),e=t.parents("tr").find("td").eq(3).text(),n=t.parents("tr").find("td").eq(0).text();l=$(this).attr("data-uid");var a=$("#myModal");a.find(".js-username").text(n),a.find(".js-email").text(e),a.find(".js-flatpickr")[0]._flatpickr.setDate([o().toDate(),o().add(-1,"month").toDate()],!0),a.find(".js-analytics-by-date").trigger("click"),$("#myModal").modal("show")}),$(document).on("click",".js-user-block,.js-user-unblock",function(){var t=r.default.ajaxUrls.moneymakerUserStateUrl,e=$(this);t=a.default.replaceUrlParams(t,e,"user-id");var n=e.data("state"),i=new FormData;i.append("state",n),$.siteAjax({url:t,method:"post",processData:!1,contentType:!1,data:i,success:function(t){"string"==typeof t&&(t=JSON.parse(t)),1==n?(e.html("Unblock"),e.data("state",2),e.removeClass("js-user-block btn-danger"),e.addClass("js-user-unblock btn-primary")):(e.html("Block"),e.data("state",1),e.removeClass("js-user-unblock btn-primary"),e.addClass("js-user-block btn-danger"))}})}),$(document).on("click",".js-user-delete",function(){var t=r.default.ajaxUrls.moneymakerUserDeleteUrl,e=$(this);t=a.default.replaceUrlParams(t,e,"user-id"),$.siteAjax({url:t,method:"delete",contentType:!1,success:function(t){"string"==typeof t&&(t=JSON.parse(t)),e.parents("tr").remove()}})})},,,,,,,,,,,,function(t,e,n){"use strict";n(8)},,,,function(t,e,n){"use strict";function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();Object.defineProperty(e,"__esModule",{value:!0});var s,u=n(0),c=n(4);!function(t){t.Range="range",t.Year="year",t.Month="month",t.Week="week",t.Day="day"}(s=e.DatePeriod||(e.DatePeriod={}));var f=function(){function t(){i(this,t),this.data=[]}return o(t,[{key:"and",value:function(t,e,n){this.data.push({name:t,operator:e,condition:";",value:n})}},{key:"or",value:function(t,e,n){this.data.push({name:t,operator:e,condition:",",value:n})}},{key:"build",value:function(){var t=!0,e="";return this.data.map(function(n){t||(e+=n.condition),e+=""+n.name+n.operator+n.value,t=!1}),e}}]),t}();e.Segment=f;var l=function(){function t(){i(this,t),this.siteId=$("#piwik-info").attr("data-site-id"),this.authToken=$("#piwik-info").attr("data-auth-token"),this.baseUrl=$("#piwik-info").attr("data-base-url"),this.timeOffset=0}return o(t,[{key:"getBaseUrl",value:function(){return this.baseUrl}},{key:"getAuthToken",value:function(){return this.authToken}},{key:"getTimeOffset",value:function(){return this.timeOffset}},{key:"getSiteId",value:function(){return this.siteId}}]),t}();e.PiwikConfig=l;var d=function(){function t(e,n){if(i(this,t),this.config=e,this.data={},this.setDate(u.default.timeHelper.userTime().format("YYYY-MM-DD"),s.Year),n)for(var a in n)n.hasOwnProperty(a)&&(this.data[a]=n[a])}return o(t,[{key:"setSegment",value:function(t){this.data.segment=t.build()}},{key:"setDateRange",value:function(t,e){this.data.period=s.Range;var n=u.default.timeHelper.getUserUtcOffset(),a=c.default.convertTimeToDifferentZone(t+" 00:00:00","YYYY-MM-DD HH:mm:ss",n,this.config.getTimeOffset()),r=c.default.convertTimeToDifferentZone(e+" 23:59:59","YYYY-MM-DD HH:mm:ss",n,this.config.getTimeOffset());this.data.date=a.format("YYYY-MM-DD")+","+r.format("YYYY-MM-DD")}},{key:"setDate",value:function(t,e){this.data.period=e;var n=u.default.timeHelper.getUserUtcOffset();this.data.date=c.default.convertTimeToDifferentZone(t+" 12:00:00","YYYY-MM-DD HH:mm:ss",n,this.config.getTimeOffset()).format("YYYY-MM-DD")}}]),o(t,[{key:"getData",value:function(){return this.data}}]),t}();e.ReportingRequest=d;var m=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),o(e,[{key:"getMethodName",value:function(){return"UserId.getUsers"}}]),e}(d);e.UserIdRequest=m;var p=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),o(e,[{key:"setVisitorId",value:function(t){this.data.visitorId=t}},{key:"getMethodName",value:function(){return"Live.getVisitorProfile"}}]),e}(d);e.VisitorProfileRequest=p;var v=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),o(e,[{key:"getMethodName",value:function(){return"Live.getLastVisitsDetails"}}]),e}(d);e.LastVisitsDetailRequest=v;var h=function(){function t(){i(this,t),this.config=new l}return o(t,[{key:"executeRequest",value:function(t,e){var n=t.getData();n.method=t.getMethodName(),n.module="API",n.idSite=this.config.getSiteId(),n.token_auth=this.config.getAuthToken(),n.format="json",$.ajax({type:"get",data:n,url:this.config.getBaseUrl(),success:function(t){e(t)}})}}]),t}();e.PiwikHelper=h},function(t,e,n){"use strict";function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(24),u=n(0),c=n(2),f=function(){function t(e){i(this,t),this.processResponse(e)}return o(t,[{key:"getVisitScreens",value:function(){return this.flattenedScreens}},{key:"getFlattenedEvents",value:function(){return this.flattenedEvents}}]),o(t,[{key:"processResponse",value:function(t){this.flattenedEvents=[];var e=this;this.flattenedScreens=[];var n={},a=[];t.map(function(t){var r=null;t.actionDetails.map(function(a){var i=new l;i.visitId=t.idVisit,i.visitIp=t.visitIp,i.visitorId=t.visitorId,i.type=a.type,i.timestamp=a.timestamp,i.idpageview=a.idpageview,"4"==i.type?(i.actionName=a.pageTitle,null!=r&&(r.duration=i.timestamp-r.timestamp,n[r.actionName]||(n[r.actionName]={count:0,duration:0}),n[r.actionName].duration+=r.duration,n[r.actionName].count++),r=i,e.flattenedScreens.push(i)):(i.actionName=a.eventName,i.actionPerformed=a.eventAction,i.eventValue=a.eventValue,i.eventCategory=a.eventCategory,e.flattenedEvents.push(i))}),a.push(r)}),a.map(function(t){n[t.actionName]&&(t.duration=Math.floor(n[t.actionName].durationchange/n[t.actionName].count),n[t.actionName].count++,n[t.actionName].duration+=t.duration)})}}]),t}();e.VisitsActivity=f;var l=function(){function t(){i(this,t)}return o(t,[{key:"timestampFormatted",get:function(){return u.default.timeHelper.convertUtcToUserTime(this.timestamp.toString(),"X").format("YYYY-MM-DD")}},{key:"timestampFormattedWithTime",get:function(){return u.default.timeHelper.convertUtcToUserTime(this.timestamp.toString(),"X").format("YYYY-MM-DD hh:mm:ss a")}},{key:"durationFormatted",get:function(){return c.duration(this.duration,"s").humanize()}}]),t}();e.FlattenedActionData=l;var d=function(t){function e(){i(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.userIdToVisitorMap={},t}return r(e,t),o(e,[{key:"getVisitor",value:function(t,e){if(this.userIdToVisitorMap[t])e(this.userIdToVisitorMap[t]);else{var n=this,a=new s.UserIdRequest(this.config),r=new s.Segment;r.and("userId","==",t),a.setSegment(r),this.executeRequest(a,function(a){a.length>0&&(n.userIdToVisitorMap[t]=a[0]),e(n.userIdToVisitorMap[t])})}}},{key:"getUserAnalyticDetail",value:function(t,e,n,a){var r=new s.LastVisitsDetailRequest(this.config),i=new s.Segment;i.and("userId","==",t),r.setSegment(i),r.setDateRange(e,n),this.executeRequest(r,function(t){a(new f(t))})}}],[{key:"getVisitorId",value:function(t){return t?t.idvisitor:null}}]),e}(s.PiwikHelper);e.default=d}],[20]);